document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector('form[action="/api/consultation-requests"]');if(e){const r=e.querySelectorAll("input, textarea, select");r.forEach(t=>{t.addEventListener("blur",u),t.addEventListener("input",c)}),e.addEventListener("submit",function(t){t.preventDefault(),f();let s=!0;if(r.forEach(n=>{u({target:n})||(s=!1)}),!s){i("Please correct the errors below.","error");return}const o=new FormData(this),a=this.querySelector('button[type="submit"]'),l=a.innerHTML;a.innerHTML="Submitting...",a.disabled=!0,fetch("/api/consultation-requests",{method:"POST",body:o,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}}).then(n=>n.json()).then(n=>{n.message&&!n.errors?(i("Thank you! Your consultation request has been submitted successfully. We will contact you within 24 hours.","success"),this.reset()):n.errors?(h(n.errors),i("Please correct the errors below.","error")):(i("Thank you! Your consultation request has been submitted successfully.","success"),this.reset())}).catch(n=>{console.error("Error:",n),i("There was an error submitting your request. Please try again.","error")}).finally(()=>{a.innerHTML=l,a.disabled=!1})})}document.querySelectorAll('a[href^="#"]').forEach(r=>{r.addEventListener("click",function(t){t.preventDefault();const s=document.querySelector(this.getAttribute("href"));s&&s.scrollIntoView({behavior:"smooth",block:"start"})})})});function u(e){const r=e.target,t=r.value.trim(),s=r.name;let o=!0,a="";if(r.hasAttribute("required")&&!t&&(a=d(s)+" is required.",o=!1),t&&o)switch(s){case"first_name":case"last_name":t.length<2&&(a=d(s)+" must be at least 2 characters.",o=!1);break;case"email":/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)||(a="Please provide a valid email address.",o=!1);break;case"phone":t.length<10&&(a="Phone number must be at least 10 characters.",o=!1);break;case"project_details":t.length<20?(a="Project details must be at least 20 characters.",o=!1):t.length>2e3&&(a="Project details must not exceed 2000 characters.",o=!1);break;case"agreed_to_terms":r.checked||(a="You must agree to the terms and conditions.",o=!1);break}return o?c({target:r}):m(r,a),o}function c(e){const r=e.target,t=r.parentNode.querySelector(".field-error");t&&t.remove(),r.classList.remove("border-red-500"),r.classList.add("border-gray-300")}function f(){document.querySelectorAll(".field-error").forEach(e=>e.remove()),document.querySelectorAll(".border-red-500").forEach(e=>{e.classList.remove("border-red-500"),e.classList.add("border-gray-300")})}function m(e,r){c({target:e});const t=document.createElement("div");t.className="field-error text-red-500 text-sm mt-1",t.textContent=r,e.parentNode.appendChild(t),e.classList.remove("border-gray-300"),e.classList.add("border-red-500")}function h(e){Object.keys(e).forEach(r=>{const t=document.querySelector(`[name="${r}"]`);t&&m(t,e[r][0])})}function d(e){return{first_name:"First name",last_name:"Last name",company:"Company",email:"Email address",phone:"Phone number",legal_challenge:"Legal challenge",project_details:"Project details",agreed_to_terms:"Terms agreement"}[e]||e}function i(e,r="info"){document.querySelectorAll(".notification").forEach(o=>o.remove());const s=document.createElement("div");s.className=`notification fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-md ${r==="success"?"bg-green-500 text-white":r==="error"?"bg-red-500 text-white":"bg-blue-500 text-white"}`,s.innerHTML=`
        <div class="flex items-center justify-between">
            <span>${e}</span>
            <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
    `,document.body.appendChild(s),setTimeout(()=>{s.parentNode&&s.remove()},5e3)}
